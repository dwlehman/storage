---
- hosts: all
  become: true
  vars:
    storage_safe_mode: false  # defaults to true, in which case no data will be removed unless explicitly requested
    mount_dir: '/opt/test1'
    disk: '/dev/sdc'

  tasks:
    - include_role:
        name: linux-system-roles.storage
      vars:
        storage_volumes:
          - name: test1
            type: disk
            disks: ["{{ disk }}"]
            mount_point: "{{ mount_dir }}"
            fs_type: ext4
            fs_label: test1  # Filesystem volume name:
            fs_create_options: '-b 1024'  # Block size:
            state: present
      tags:
        - setup

    - include_role:
        name: linux-system-roles.storage
      vars:
        storage_volumes:
          - name: test1
            type: disk
            disks: ["{{ disk }}"]
            mount_point: "{{ mount_dir }}"
            state: absent
      tags:
        - cleanup
